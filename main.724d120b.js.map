{"version":3,"sources":["js/modules/serverComm.js","js/modules/helpers.js","js/modules/gameField.js","js/main.js"],"names":["serverComm","URL","fieldData","response","fetch","method","body","JSON","stringify","result","json","document","querySelector","removeElem","elemClass","remove","setSessionGridArray","array","sessionStorage","setItem","getSessionGridArray","parse","getItem","Cell","x","y","z","value","generateField","elemCoefficient","fieldSize","gridArray","counter","i","j","k","push","drawGrid","field","fieldWidth","offsetWidth","fieldHeigth","offsetHeight","cellWidth","toFixed","cellHeigth","Math","sqrt","divElem","createElement","className","innerHTML","cellClass","posX","posY","centerX","centerY","length","append","updateCells","dataArray","forEach","element","data","hexGridArray","initField","inputRadius","parseInt","console","log","getRowArray","axis","index","rowArray","getUpdatedRow","direction","moveArr","getUpdate","fieldRadius","indexArr","updatedHexGridArray","indexVal","movedRow","apply","baseURL","initialDataReq","target","reqURL","then","logKey","e","code","getDirection","addEventListener","closest"],"mappings":"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","file":"main.724d120b.js","sourceRoot":"..","sourcesContent":["async function serverComm(URL, fieldData) {\r\n  let response = await fetch(URL, {\r\n    method: \"POST\",\r\n    body: JSON.stringify(fieldData),\r\n  });\r\n\r\n  let result = await response.json();\r\n  // console.log(result);\r\n  return result;\r\n}\r\n\r\nexport default serverComm;\r\n","const body = document.querySelector(\"body\");\r\n\r\nfunction removeElem(elemClass) {\r\n  if (!!body.querySelector(elemClass)) {\r\n    body.querySelector(elemClass).remove();\r\n  }\r\n}\r\n\r\nfunction setSessionGridArray(array) {\r\n  sessionStorage.setItem(\"hexGridArray\", JSON.stringify(array));\r\n}\r\n\r\nfunction getSessionGridArray() {\r\n  return JSON.parse(sessionStorage.getItem(\"hexGridArray\"));\r\n}\r\n\r\nexport { removeElem, setSessionGridArray, getSessionGridArray };\r\n","import { removeElem, setGridArray, getGridArray } from \"./helpers\";\r\n\r\nfunction Cell(x, y, z, value) {\r\n  this.x = x;\r\n  this.y = y;\r\n  this.z = z;\r\n  this.value = value;\r\n}\r\n\r\nfunction generateField(elemCoefficient) {\r\n  const fieldSize = elemCoefficient;\r\n  const gridArray = [];\r\n  let counter = 0;\r\n\r\n  for (let i = -fieldSize; i < fieldSize + 1; i += 1) {\r\n    for (let j = -fieldSize; j < fieldSize + 1; j += 1) {\r\n      for (let k = -fieldSize; k < fieldSize + 1; k += 1) {\r\n        if (i + j + k == 0) {\r\n          gridArray.push(new Cell(i, j, k, 0));\r\n          counter += 1;\r\n        }\r\n      }\r\n    }\r\n  }\r\n  // console.log(gridArray);\r\n  return gridArray;\r\n}\r\n\r\nfunction drawGrid(gridArray, elemCoefficient) {\r\n  const field = document.querySelector(\".game-field\");\r\n  const fieldWidth = field.offsetWidth;\r\n  const fieldHeigth = field.offsetHeight;\r\n\r\n  const elemRadius = elemCoefficient * 2 - 1;\r\n  const cellSize = fieldWidth / (elemCoefficient * 4 + 1);\r\n\r\n  const cellWidth = (cellSize * 2).toFixed(2);\r\n  const cellHeigth = ((cellWidth * Math.sqrt(3)) / 2).toFixed(2);\r\n  const divElem = document.createElement(\"div\");\r\n  divElem.className = \"hex-grid\";\r\n  divElem.innerHTML = ``;\r\n\r\n  let cellClass = \"css-2\";\r\n\r\n  switch (elemCoefficient) {\r\n    case 2:\r\n      cellClass = \"css-3\";\r\n      break;\r\n    case 3:\r\n      cellClass = \"css-4\";\r\n  }\r\n\r\n  let x, y, z, value;\r\n  let posX, posY;\r\n  let centerX = fieldWidth / 2;\r\n  let centerY = fieldHeigth / 2;\r\n\r\n  for (let i = 0; i < gridArray.length; i++) {\r\n    [x, y, z, value] = [\r\n      gridArray[i].x,\r\n      gridArray[i].y,\r\n      gridArray[i].z,\r\n      gridArray[i].value,\r\n    ];\r\n    posX = (x * 3 * cellWidth) / 4 + centerX - cellWidth / 2;\r\n    posY = ((-y + z) * cellHeigth) / 2 + centerY - cellHeigth / 2;\r\n    divElem.innerHTML += `\r\n    <div class=\"${cellClass}\" \r\n      data-value=\"${value}\" \r\n      data-x=\"${x}\" \r\n      data-y=\"${y}\" \r\n      data-z=\"${z}\" \r\n      style=\"left: ${posX}px; top: ${posY}px;\">${value || \"\"}</div>\r\n    `;\r\n  }\r\n  removeElem(\".hex-grid\");\r\n  field.append(divElem);\r\n  // console.log(\r\n  //   `${elemCoefficient} ${elemRadius} ${cellWidth} ${cellHeigth} ${cellSize}`\r\n  // );\r\n}\r\n\r\nfunction updateCells(gridArray, dataArray) {\r\n  gridArray.forEach((element) => {\r\n    dataArray.forEach((data) => {\r\n      const result =\r\n        element.x === data.x && element.y === data.y && element.z === data.z;\r\n      if (!!result) {\r\n        element.value = data.value;\r\n      }\r\n    });\r\n  });\r\n}\r\n\r\nlet elemCoefficient = 1;\r\nlet hexGridArray = [];\r\n\r\nfunction initField(inputRadius, data) {\r\n  elemCoefficient = parseInt(inputRadius) - 1;\r\n  hexGridArray = generateField(elemCoefficient);\r\n  updateCells(hexGridArray, data);\r\n  console.log(data);\r\n  console.log(hexGridArray);\r\n  // setGridArray(hexGridArray);\r\n  drawGrid(hexGridArray, elemCoefficient);\r\n}\r\n\r\nfunction getRowArray(axis, index) {\r\n  const rowArray = [];\r\n  // console.log(hexGridArray);\r\n  hexGridArray.forEach((element) => {\r\n    // console.log(element[axis]);\r\n    if (element[axis] === index) {\r\n      rowArray.push(element);\r\n    }\r\n  });\r\n  return rowArray;\r\n}\r\n\r\n// **\r\n// direction Boolean  - true for positive / false for negative\r\n\r\nfunction getUpdatedRow(rowArray, direction) {\r\n  const moveArr = [...rowArray];\r\n  console.log(`111: ${JSON.stringify(moveArr)}`);\r\n  if (!direction) {\r\n    for (let i = 1; i < moveArr.length; i++) {\r\n      if (moveArr[i - 1].value === 0) {\r\n        moveArr[i - 1].value = moveArr[i].value;\r\n        moveArr[i].value = 0;\r\n      }\r\n    }\r\n  } else {\r\n    for (let i = moveArr.length - 2; i >= 0; i--) {\r\n      if (moveArr[i + 1].value === 0) {\r\n        moveArr[i + 1].value = moveArr[i].value;\r\n        moveArr[i].value = 0;\r\n      }\r\n    }\r\n  }\r\n  console.log(`222: ${JSON.stringify(moveArr)}`);\r\n  return moveArr;\r\n}\r\n\r\nfunction getUpdate(axis, fieldRadius, direction) {\r\n  const indexArr = [];\r\n  for (let i = -fieldRadius + 1; i < fieldRadius; i++) {\r\n    indexArr.push(i);\r\n  }\r\n  let updatedHexGridArray = [];\r\n\r\n  for (let indexVal of indexArr) {\r\n    let rowArray = getRowArray(axis, indexVal);\r\n    let movedRow = getUpdatedRow(rowArray, direction);\r\n    updatedHexGridArray.push.apply(updatedHexGridArray, movedRow);\r\n  }\r\n\r\n  console.log(`333: ${JSON.stringify(updatedHexGridArray)}`);\r\n  drawGrid(updatedHexGridArray, elemCoefficient);\r\n}\r\n\r\nexport { initField, updateCells, drawGrid, getUpdate };\r\n","import serverComm from \"./modules/serverComm\";\r\nimport { initField as gameField, getUpdate } from \"./modules/gameField\";\r\n// import {removeElem} from \"./modules/helpers\";\r\n\r\nconst baseURL = \"http://51.15.207.127:13337\";\r\nlet fieldData = [];\r\nlet fieldRadius;\r\n\r\nconst body = document.querySelector(\"body\");\r\nbody.addEventListener(\"click\", function (e) {\r\n  const target = e.target;\r\n  if (!!target.closest(\".radius-btn\")) {\r\n    fieldRadius = target.value;\r\n    initialDataReq(target);\r\n  }\r\n});\r\n\r\nfunction initialDataReq(target) {\r\n  const reqURL = `${baseURL}/${target.value}`;\r\n\r\n  // removeElem(\".hex-grid\");\r\n\r\n  serverComm(reqURL, fieldData).then((result) =>\r\n    gameField(target.value, result)\r\n  );\r\n}\r\n\r\nfunction logKey(e) {\r\n  console.log(e.code);\r\n}\r\n\r\ndocument.addEventListener(\"keydown\", getDirection);\r\n\r\nfunction getDirection(e) {\r\n  logKey(e);\r\n  let direction;\r\n\r\n  switch (e.code) {\r\n    case \"KeyW\":\r\n      direction = \"x+\";\r\n      getUpdate(\"x\", fieldRadius, true);\r\n      break;\r\n    case \"KeyS\":\r\n      direction = \"x-\";\r\n      getUpdate(\"x\", fieldRadius, false);\r\n      break;\r\n    case \"KeyE\":\r\n      direction = \"y+\";\r\n      break;\r\n    case \"KeyA\":\r\n      direction = \"y-\";\r\n      break;\r\n    case \"KeyD\":\r\n      direction = \"z+\";\r\n      break;\r\n    case \"KeyQ\":\r\n      direction = \"z-\";\r\n      break;\r\n    default:\r\n      return;\r\n  }\r\n\r\n  console.log(direction);\r\n}\r\n"]}